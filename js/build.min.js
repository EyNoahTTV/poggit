var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,l,g){b instanceof String&&(b=String(b));for(var h=b.length,d=0;d<h;d++){var m=b[d];if(l.call(g,m,d,b))return{i:d,v:m}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,l,g){b!=Array.prototype&&b!=Object.prototype&&(b[l]=g.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,l,g,h){if(l){g=$jscomp.global;b=b.split(".");for(h=0;h<b.length-1;h++){var d=b[h];d in g||(g[d]={});g=g[d]}b=b[b.length-1];h=g[b];l=l(h);l!=h&&null!=l&&$jscomp.defineProperty(g,b,{configurable:!0,writable:!0,value:l})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,g){return $jscomp.findInternal(this,b,g).v}},"es6","es3");
$(function(){function b(a,b){var c=$("<div id='toggle-wrapper' class='toggle-wrapper'></div>");c.html("<p>Loading repos...</p>");c.attr("data-name",a);c.attr("data-opened",b?"false":"true");var e=toggleFunc(c);ajax("ci.project.list",{data:{owner:a},success:function(c){console.log(a);var b=$("<table></table>");b.css("width","100%");var f={},d;for(d in c)if(c.hasOwnProperty(d)){f.repo=c[d];f.isEnabled=!0===f.repo.build;console.log("repo "+f.repo.name+": ",f.isEnabled);var t=$("<tr></tr>");$("<td></td>").append($("<a></a>").text(f.repo.name.substr(0,
14)+(14<f.repo.name.length?"...":"")).attr("href",getRelativeRootPath()+"ci/"+a+"/"+f.repo.name)).append(generateGhLink("https://github.com/"+a+"/"+f.repo.name)).appendTo(t);$("<td id=prj-"+f.repo.id+"></td>").text(f.isEnabled?f.repo.projectsCount:"").appendTo(t);var k=$("<div class='toggle toggle-light' id=btn-"+f.repo.id+"></div>");k.css("float","right");k.text(f.isEnabled?"Disable":"Enable");k.toggles({drag:!0,click:!0,text:{on:"ON",off:"OFF"},animate:250,easing:"swing",checkbox:null,clicker:null,
type:"compact"});k.toggles(f.isEnabled);k.toggleClass("disabled",!0);k.click(function(a){return function(){var c=$("#enableRepoBuilds");c.data("repoId",a.repo.id);var b=a.isEnabled?"Disable":"Enable",f="auto";c.data("target",a.isEnabled?"false":"true");console.log("Click "+a.repo.name+", ",a.isEnabled);a.isEnabled?(f="300px",c.find("#detailLoader").text("Click Confirm to Disable Poggit-CI for "+a.repo.name+"."),$("#confirm").button({disabled:!1})):(l(c,a.repo),$("#confirm").button({disabled:!0}));
c.dialog({title:b+" Poggit-CI",width:f,height:"auto",position:modalPosition});$(".ui-dialog-titlebar button:contains('Close')").prop("title","");c.dialog("open")}}(f));t.append($("<td></td>").append(k));t.appendTo(b);f={repo:f.repo,isEnabled:f.isEnabled}}$(e).empty().append(b)}});return c}function l(a,b){var c=a.find("#detailLoader");c.text("Loading details...");a=a.dialog("option","buttons");for(var d,k=0;k<a.length;k++){var e=a[k];if("confirm"===e.id){d=e;break}}console.assert("object"===typeof d);
ajax("build.scanRepoProjects",{data:{repoId:b.id},success:function(a,d,e){if("error/bad_request"===a.status)c.empty(),$("<div><h5>400 - Bad Request</h5><p><br/>"+a.message+"</p></div>").appendTo(c);else if("success"!==a.status)c.empty(),$('<div><p>A internal server error occurred.<br/>Please use this request ID for reference if you need support:\n<code class="code">'+e.getResponseHeader("X-Poggit-Request-ID")+"</code></p></div>").appendTo(c);else{a=a.yaml;d=(30>a.split(/\r\n|\r|\n/).length?a.split(/\r\n|\r|\n/).length:
30)-1;e=$("<div><h3>"+b.name+"</h3></div>");c.empty();e.appendTo(c);e=$("<div class='cbinput'></div>");var k=$('<input type="checkbox" checked id="manifestEditConfirm">');k.change(function(){document.getElementById("selectManifestFile").disabled=!this.checked;document.getElementById("inputManifestContent").disabled=!this.checked});k.appendTo(e);e.append("Commit default .poggit.yml to the repo");e.appendTo(c);e=$("<p></p>");e.text("After Poggit-CI is enabled for this repo, a manifest file will be created at: ");
$("<select id='selectManifestFile'><option value='.poggit.yml' selected>.poggit.yml</option></select>").appendTo(e);e.appendTo(c);e=$("<p></p>");e.text("Attribute information for .poggit.yml can be found at: ");$("<a href='https://github.com/poggit/support/blob/master/poggit.yml.d.ts'>poggit/support</a>").appendTo(e);e.appendTo(c);e=$("<div class='manifestarea'>Content of the manifest:<br/></div>");d=$("<textarea id='inputManifestContent' rows='"+d+"'></textarea>");d.text(a);d.appendTo(e);e.appendTo(c);
$("#enableRepoBuilds").dialog({position:{my:"center top",at:"center top+100",of:window}});$("#confirm").button({disabled:!1})}},error:function(a){c.empty();$('<div><h5>500 - Internal server error</h5><p><br/>Please try again later or use this request ID for reference if you need support:\n<code class="code">'+a.getResponseHeader("X-Poggit-Request-ID")+"</code></p></div>").appendTo(c)},method:"POST"})}function g(a,e){var c={repoId:e.data("repoId"),enabled:e.data("target")},b;"true"===c.enabled&&document.getElementById("manifestEditConfirm").checked&&
(b=e.find("#selectManifestFile"))&&(c.manifestFile=b.val(),c.manifestContent=e.find("#inputManifestContent").val());ajax("ajax.toggleRepo",{data:c,method:"POST",success:function(c){c.success?(c.enabled?($("#prj-"+c.repoId).text(c.projectsCount),$(".toggle-ajax-pane").prepend(c.panelHtml),$("#detailLoader").empty()):($("#repo-"+c.repoId).remove(),$("#prj-"+c.repoId).text("0")),a.dialog("close"),$("#btn-"+c.repoId).toggles(c.enabled),$("#confirm").attr("disabled",!1)):alert(c.message)}})}var h=$("#inputSearch"),
d=$("#inputUser"),m=$("#inputRepo"),p=$("#inputProject"),r=$("#inputBuild"),q=$("#gotoRecent"),B=$("#gotoAdmin"),C=$("#gotoSelf"),D=$("#gotoVirions"),y=$("#gotoSearch"),u=$("#gotoUser"),v=$("#gotoRepo"),w=$("#gotoProject"),x=$("#gotoBuild"),n=function(){var a=!d.val().trim(),b=!(d.val().trim()&&m.val().trim()),c=!(d.val().trim()&&m.val().trim()&&p.val().trim()),g=!(d.val().trim()&&m.val().trim()&&p.val().trim()&&r.val().trim());u.hasClass("disabled")!==a&&u.toggleClass("disabled");v.hasClass("disabled")!==
b&&v.toggleClass("disabled");w.hasClass("disabled")!==c&&w.toggleClass("disabled");x.hasClass("disabled")!==g&&x.toggleClass("disabled")};if(0!==window.location.hash.length){var z=$("a[name="+window.location.hash.substring(1)+"]").parent().offset();"undefined"!==typeof z&&$("html, body").animate({scrollTop:z.top},300)}"/ci"!==window.location.pathname||sessionData.session.isLoggedIn||window.history.replaceState(null,"","/ci/recent");d.keydown(function(){setTimeout(n,50)});d.change(n);d.keyup(function(a){13===
a.keyCode&&u.click()});h.keydown(function(){setTimeout(n,50)});h.change(n);h.keyup(function(a){13===a.keyCode&&y.click()});m.keydown(function(){setTimeout(n,50)});m.change(n);m.keyup(function(a){13===a.keyCode&&v.click()});p.keydown(function(){setTimeout(n,50)});p.change(n);p.keyup(function(a){13===a.keyCode&&w.click()});r.keydown(function(){setTimeout(n,50)});r.change(n);r.keyup(function(a){13===a.keyCode&&x.click()});C.click(function(){window.location.assign(getRelativeRootPath()+"ci/"+getLoginName())});
D.click(function(){window.location.assign(getRelativeRootPath()+"v")});B.click(function(){window.location.assign(getRelativeRootPath()+"ci")});q.click(function(){window.location.assign(getRelativeRootPath()+"ci/recent")});y.click(function(){var a=$("#search-results");if(""===h.val())a.empty(),a.attr("hidden",!0);else{a.text("Loading Search Results...");var b={search:h.val()};ajax("search.ajax",{data:b,method:"POST",success:function(c){a.empty();a.html(c.html);a.attr("hidden",!1);$("#inputSearch").val("")},
error:function(a,b,e){alert(e)}})}});u.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+d.val()});v.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+d.val()+"/"+m.val()});w.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+d.val()+"/"+m.val()+"/"+
p.val()});x.click(function(){$(this).hasClass("disabled")?alert("Please fill in the required fields"):window.location=getRelativeRootPath()+"ci/"+d.val()+"/"+m.val()+"/"+p.val()+"/"+$("#inputBuildClass").val()+":"+r.val()});$("#rbp-dl-direct").click(function(a){var b=confirm("This is a development build; it has not been reviewed and may contain dangerous code, including viruses. Do you still want to download this file?");gaEventCi(!1,!b,this.getAttribute("data-project-name"),this.getAttribute("data-rsr-id"),
!1);b||a.preventDefault()});$("#rbp-dl-as").click(function(){var a=this.getAttribute("data-rsr-id"),b=this.getAttribute("data-dl-name"),c=confirm("This is a development build; it has not been reviewed and may contain dangerous code, including viruses. Do you still want to download this file?");gaEventCi(!1,!c,this.getAttribute("data-project-name"),this.getAttribute("data-rsr-id"),!0);c&&(b=prompt("Filename to download with:",b),null!==b&&(window.location=getRelativeRootPath()+"r/"+a+"/"+b))});$("#toggle-project-sub").click(function(){var a=
this.getAttribute("data-project-id"),b=document.getElementById("select-project-sub").value,c=$("#project-subscribe");c.addClass("disabled");c.prop("onclick",null).off("click");ajax("ci.project.togglesub",{data:{projectId:a,level:b},success:function(){window.location.reload(!0)}})});var A=$("#enableRepoBuilds");(function(){var a=$("#toggle-orgs");0!==a.length&&(a.empty(),b(getLoginName(),!1).appendTo(a),ghApi("user/orgs",{},"GET",function(d){for(var c=0;c<d.length;c++)b(d[c].login,!0).appendTo(a)}))})();
A.dialog({autoOpen:!1,dialogClass:"no-close",closeOnEscape:!0,close:function(a){a.originalEvent&&$("#detailLoader").empty()},buttons:[{id:"confirm",text:"Confirm",click:function(){$("#confirm").attr("disabled",!0);g($(this),A)}}],modal:!0});q=$("#recentBuilds");16<q.find("> div").length&&"on"===getParameterByName("usePages",!1!==sessionData.opts.usePages?"on":"off")&&q.paginate({perPage:16,scope:$("div")});q=$("#repo-list-build-wrapper");12<q.find("> div").length&&"on"===getParameterByName("usePages",
!1!==sessionData.opts.usePages?"on":"off")&&q.paginate({perPage:12,scope:$("div")})});
